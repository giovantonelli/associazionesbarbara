<!DOCTYPE html>
<html lang="it">
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eventi - Associazione Santa Barbara APS</title>
  <meta name="description" content="Calendario eventi e attività dell'Associazione Santa Barbara APS">
  <meta name="keywords" content="eventi, calendario, attività, associazione, santa barbara">
  <meta property="og:title" content="Eventi - Associazione Santa Barbara APS">
  <meta property="og:description" content="Calendario eventi e attività dell'Associazione Santa Barbara APS">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://associazionesbarbara.it/eventi.html">
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
  <link rel="shortcut icon" href="/favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="S.Barbara" />
  <link rel="manifest" href="/favicon/site.webmanifest" />
  <script>
                        // Define dataLayer and the gtag function
                        window.dataLayer = window.dataLayer || [];

                        function gtag() {
                                dataLayer.push(arguments);
                        }
                        // Set default consent to 'denied' as a placeholder for EU users
                        gtag('consent', 'default', {
                                'ad_storage': 'denied',
                                'ad_user_data': 'denied',
                                'ad_personalization': 'denied',
                                'analytics_storage': 'denied',
                                'wait_for_update': 500
                        });
  </script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-F465WJF33T"></script>
  <script>
                        gtag('js', new Date());
                        gtag('config', 'G-F465WJF33T');
  </script>
  <style>
.event-modal {
  display: none;
  position: fixed;
  top: 0; left: 0;
  width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.45);
  z-index: 9999;
  align-items: center; justify-content: center;
  transition: opacity 0.25s;
  opacity: 0;
}
.event-modal.show {
  display: flex;
  opacity: 1;
}
.modal-content {
  background: #fff;
  border-radius: 20px;
  max-width: 700px;
  min-width: 320px;
  width: 90vw;
  min-height: 120px;
  padding: 2.5em 2em 2em 2em;
  box-shadow: 0 12px 48px rgba(0,0,0,0.18);
  position: relative;
  animation: modalIn 0.35s cubic-bezier(.42,1.2,.58,1) forwards;
}
@keyframes modalIn {
  0% { transform: scale(0.85) translateY(40px); opacity: 0; }
  100% { transform: scale(1) translateY(0); opacity: 1; }
}
#close-modal {
  position: absolute;
  top: 18px; right: 18px;
  background: none;
  border: none;
  font-size: 2em;
  color: #E10600;
  cursor: pointer;
  transition: color 0.2s;
}
#close-modal:hover { color: #b30000; }
#modal-html-content {
  margin-top: 1.5em;
  font-size: 1.13em;
  color: #222;
  line-height: 1.7;
  word-break: break-word;
}
.public-events-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2em;
  margin-bottom: 2em;
}
@media (max-width: 600px) {
  .public-events-grid {
    grid-template-columns: 1fr;
    gap: 1.2em;
  }
}
.evento-card {
  transition: box-shadow 0.25s, transform 0.18s;
}
.evento-card:hover {
  box-shadow: 0 8px 40px rgba(225,6,0,0.18), 0 2px 16px rgba(34,58,108,0.08);
  transform: translateY(-4px) scale(1.025);
  z-index: 2;
}
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="container">
      <div class="nav-brand">
        <a href="index.html" class="nav-brand-link"><img src="assets/images/logo.svg" alt="Logo Associazione Santa Barbara APS" class="logo"> <span class="brand-text">Associazione Santa Barbara APS</span></a>
      </div><button class="nav-toggle" aria-label="Toggle navigation"></button>
      <ul class="nav-menu">
        <li>
          <a href="index.html" class="nav-link">Home</a>
        </li>
        <li>
          <a href="chi-siamo.html" class="nav-link">Chi siamo</a>
        </li>
        <li>
          <a href="attivita.html" class="nav-link">Attività</a>
        </li>
        <li>
          <a href="eventi.html" class="nav-link active">Eventi</a>
        </li>
        <li>
          <a href="galleria.html" class="nav-link">Galleria</a>
        </li>
        <li>
          <a href="faq.html" class="nav-link">FAQ</a>
        </li>
        <li>
          <a href="contatti.html" class="nav-link">Contatti</a>
        </li>
        <li>
          <a href="partner.html" class="nav-link">Partner</a>
        </li>
        <li>
          <a href="area-soci.html" class="nav-link btn btn-primary">Area Soci</a>
        </li>
      </ul>
    </div>
  </nav>
  <div id="user-bar"></div>
  <section class="page-header">
    <div class="container">
      <h1>Eventi</h1>
      <p>Scopri tutti i nostri eventi e attività in programma</p>
    </div>
  </section>
  <main class="eventi-main" style="max-width:900px;margin:40px auto 0 auto;padding:0 1rem;">
    <h1 style="text-align:center;color:#E10600;font-size:2.2em;margin-bottom:1.2em;letter-spacing:1px;">Eventi Pubblici</h1>
    <h2 style="color:#E10600;font-size:1.5em;margin-bottom:0.7em;">Prossimi Eventi</h2>
    <div id="future-events-list" class="public-events-grid"></div>
    <h2 style="color:#888;font-size:1.2em;margin:2.5em 0 0.7em 0;letter-spacing:1px;">Eventi Passati</h2>
    <div id="past-events-section" style="background:#f7f7f7;border-radius:18px;padding:1.5em 1em 1.5em 1em;margin-bottom:2em;border:1px solid #e0e0e0;">
      <div id="past-events-list" class="public-events-grid"></div>
    </div>
    <!-- Popup Modale Evento -->
    <div id="event-modal" class="event-modal">
      <div class="modal-content">
        <button id="close-modal">&times;</button>
        <div id="modal-html-content"></div>
      </div>
    </div>
  </main>
  <!-- Footer Banner Ad -->
  <footer class="footer">
    <div class="container">
      <div class="footer-content">
        <div class="footer-section">
          <img src="assets/images/logo.svg" alt="Logo Associazione Santa Barbara APS" class="footer-logo">
          <p>Associazione Santa Barbara APS</p>
          <p>Promuoviamo la cultura e il volontariato nel nostro territorio</p>
        </div>
        <div class="footer-section">
          <h4>Link utili</h4>
          <ul>
            <li>
              <a href="chi-siamo.html">Chi siamo</a>
            </li>
            <li>
              <a href="attivita.html">Attività</a>
            </li>
            <li>
              <a href="eventi.html">Eventi</a>
            </li>
            <li>
              <a href="contatti.html">Contatti</a>
            </li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Informazioni</h4>
          <ul>
            <li>
              <a href="privacy.html">Privacy Policy</a>
            </li>
            <li>
              <a href="faq.html">FAQ</a>
            </li>
            <li>
              <a href="area-soci.html">Area Soci</a>
            </li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Seguici</h4>
          <div class="social-links">
            <a href="https://www.facebook.com/santabarbara.grumoappula" class="social-link" aria-label="Facebook"><svg width="24" height="24" viewbox="0 0 24 24" fill="currentcolor">
            <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></a> <a href="https://www.instagram.com/corteostoricosantabarbara/" class="social-link" aria-label="Instagram"><svg width="24" height="24" viewbox="0 0 24 24" fill="currentcolor">
            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"></path></svg></a> <a href="https://t.me/associazionesbarbara" class="social-link" aria-label="Telegram"><svg width="24" height="24" viewbox="0 0 24 24" fill="currentcolor">
            <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"></path></svg></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>© 2008- <span id="current-year"></span> Associazione Santa Barbara APS. Tutti i diritti riservati.<br>
        <span style="letter-spacing:2px; font-size:0.95em; color:#222;"><a href="privacy.html" style="color:#e67e22; text-decoration:underline;">PRIVACY POLICY</a> <span style="margin:0 10px;">|</span> <a href="#" style="color:#e67e22; text-decoration:underline;" onclick="window.cookieConsent && window.cookieConsent.open(); return false;">GESTISCI COOKIE</a></span></p>
      </div>
    </div>
  </footer>
  <script src="assets/js/notifications.js"></script> 
  <script src="assets/js/script.js"></script> 
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
  // Supabase config
  const { createClient } = supabase;
  const supabaseClient = createClient('https://ciezrbsolxpjxswdkkpo.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpZXpyYnNvbHhwanhzd2Rra3BvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI5MjM1NjAsImV4cCI6MjA2ODQ5OTU2MH0.V-U8KhO8byObUW5kJ8XbLBkp9O9Efh98MdbKYFfbQJk');

  async function loadPublicEvents() {
    const eventsList = document.getElementById('public-events-list');
    document.getElementById('future-events-list').innerHTML = '<div style="text-align:center;color:#E10600;font-size:1.1em;">Caricamento eventi...</div>';
    document.getElementById('past-events-list').innerHTML = '';
    const { data, error } = await supabaseClient.from('events').select('*').eq('is_public', true).order('event_date', { ascending: true });
    if (error) {
      document.getElementById('future-events-list').innerHTML = `<div style="color:red;text-align:center;">Errore nel caricamento eventi: ${error.message}</div>`;
      return;
    }
    if (!data || data.length === 0) {
      document.getElementById('future-events-list').innerHTML = '<div style="text-align:center;color:#444;">Nessun evento pubblico disponibile al momento.</div>';
      return;
    }
    // Dividi eventi futuri e passati
    const now = new Date();
    const futureEvents = [];
    const pastEvents = [];
    data.forEach(ev => {
      const eventDate = ev.event_date ? new Date(ev.event_date) : null;
      if (eventDate && eventDate.setHours(0,0,0,0) >= now.setHours(0,0,0,0)) {
        futureEvents.push(ev);
      } else {
        pastEvents.push(ev);
      }
    });
    // Ordina futuri per data crescente, passati per data decrescente
    futureEvents.sort((a, b) => new Date(a.event_date) - new Date(b.event_date));
    pastEvents.sort((a, b) => new Date(b.event_date) - new Date(a.event_date));
    // Renderizza eventi futuri
    const renderCard = (ev, isPast = false) => {
      const img = ev.image_url ? `<img src="${ev.image_url}" alt="Locandina evento" style="max-width:340px;border-radius:12px;box-shadow:0 2px 16px rgba(225,6,0,0.10);margin-bottom:1.2em;${isPast ? 'filter:grayscale(0.7) contrast(0.95);opacity:0.85;' : ''}">` : '';
      const date = ev.event_date ? new Date(ev.event_date).toLocaleDateString('it-IT') : '';
      const time = ev.event_time ? `Ore ${ev.event_time}` : '';
      const location = ev.location ? `<span style="font-size:1.05em;">${ev.location}</span>` : '';
      return `
        <section class="evento-card" style="background:${isPast ? '#f3f3f3' : '#fff'};border-radius:18px;box-shadow:0 4px 32px rgba(225,6,0,0.06);padding:2.5em 2em 2em 2em;display:flex;flex-direction:column;align-items:center;cursor:${isPast ? 'default' : 'pointer'};transition:box-shadow 0.2s;${isPast ? 'opacity:0.85;' : ''}" data-event-id="${ev.id}">
          <div style="width:100%;text-align:center;">
            <h2 style="color:${isPast ? '#b0b0b0' : '#E10600'};font-size:1.5em;margin-bottom:0.5em;">${ev.title || 'Evento'}</h2>
            <p style="font-size:1.15em;color:${isPast ? '#888' : '#222'};margin-bottom:1.2em;">
              <strong>${date}</strong><br>
              <span style="font-size:1.1em;color:${isPast ? '#b0b0b0' : '#E10600'};">${time}</span><br>
              ${location}
            </p>
            ${img}
            <p style="font-size:1.08em;color:${isPast ? '#aaa' : '#444'};line-height:1.6;margin-bottom:1.2em;">${ev.description || ''}</p>
            ${ev.external_link && !isPast ? `<a href="${ev.external_link}" target="_blank" style="display:inline-block;background:#E10600;color:#fff;padding:0.7em 1.6em;border-radius:8px;font-size:1.08em;text-decoration:none;box-shadow:0 2px 8px rgba(225,6,0,0.10);transition:background 0.2s;">Info evento</a>` : ''}
          </div>
        </section>
      `;
    };
    document.getElementById('future-events-list').innerHTML = futureEvents.length ? futureEvents.map(ev => renderCard(ev, false)).join('') : '<div style="text-align:center;color:#444;">Nessun evento futuro.</div>';
    document.getElementById('past-events-list').innerHTML = pastEvents.length ? pastEvents.map(ev => renderCard(ev, true)).join('') : '<div style="text-align:center;color:#888;">Nessun evento passato.</div>';
    // Event listener per popup
    setTimeout(() => {
      document.querySelectorAll('.evento-card[data-event-id]').forEach(card => {
        card.addEventListener('click', async function(e) {
          e.preventDefault();
          const eventId = card.getAttribute('data-event-id');
          const modal = document.getElementById('event-modal');
          const modalContent = document.getElementById('modal-html-content');
          modalContent.innerHTML = '<div style="text-align:center;color:#E10600;">Caricamento...</div>';
          modal.classList.add('show');
          // Recupera content HTML da Supabase
          const { data: eventData, error: eventError } = await supabaseClient.from('events').select('content').eq('id', eventId).single();
          if (eventError || !eventData) {
            modalContent.innerHTML = `<div style="color:red;text-align:center;">Errore: ${eventError ? eventError.message : 'Evento non trovato'}</div>`;
            return;
          }
          modalContent.innerHTML = `<div>${eventData.content}</div>`;
        });
      });
      document.getElementById('close-modal').addEventListener('click', function() {
        document.getElementById('event-modal').classList.remove('show');
      });
      document.getElementById('event-modal').addEventListener('click', function(e) {
        if (e.target === this) this.classList.remove('show');
      });
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') document.getElementById('event-modal').classList.remove('show');
      });
    }, 500);
  }
  document.addEventListener('DOMContentLoaded', loadPublicEvents);
  </script>
  <script>

                        // Check if user is logged in to show member events
                        document.addEventListener('DOMContentLoaded', function() {
                                const currentUser = localStorage.getItem('currentUser');
                                if (currentUser) {
                                        document.getElementById('login-required').style.display = 'none';
                                        document.getElementById('members-calendar').style.display = 'block';
                                        document.getElementById('members-events').style.display = 'block';
                                }
                        });
  </script> 
  <script src="assets/js/adblock-detector-v2.js"></script> 
  <script src="assets/js/adblock-integration-v2.js"></script>
  
</body>
</html>
